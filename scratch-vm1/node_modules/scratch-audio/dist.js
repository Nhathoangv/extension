module.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";var i=n(8);i.enable(),t.exports=i("scratch-audioengine")},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.audioEngine=e,this.audioPlayer=n,this.lastEffect=i,this.value=this.DEFAULT_VALUE,this.initialized=!1,this.inputNode=null,this.outputNode=null,this.target=null}return i(t,[{key:"getInputNode",value:function(){return this._isPatch?this.inputNode:this.target.getInputNode()}},{key:"initialize",value:function(){throw new Error(this.constructor.name+".initialize is not implemented.")}},{key:"_set",value:function(){throw new Error(this.constructor.name+"._set is not implemented.")}},{key:"set",value:function(t){this.initialized||this.initialize();var e=this._isPatch;e&&(this._lastPatch=this.audioEngine.currentTime),this._set(t),this._isPatch!==e&&null!==this.target&&this.connect(this.target)}},{key:"update",value:function(){}},{key:"clear",value:function(){this.set(this.DEFAULT_VALUE)}},{key:"connect",value:function(t){var e=this;if(null===t)throw new Error("target may not be null");if(function t(n){if(n)return n===e||t(n.target)}(t))throw new Error("Effect cannot connect to itself");this.target=t,null!==this.outputNode&&this.outputNode.disconnect(),(this._isPatch||this._lastPatch+this.audioEngine.DECAY_DURATION<this.audioEngine.currentTime)&&this.outputNode.connect(t.getInputNode()),null===this.lastEffect?null!==this.audioPlayer&&this.audioPlayer.connect(this):this.lastEffect.connect(this)}},{key:"dispose",value:function(){this.inputNode=null,this.outputNode=null,this.target=null,this.initialized=!1}},{key:"name",get:function(){throw new Error(this.constructor.name+".name is not implemented")}},{key:"DEFAULT_VALUE",get:function(){return 0}},{key:"_isPatch",get:function(){return this.initialized&&(this.value!==this.DEFAULT_VALUE||null===this.audioPlayer)}}]),t}();t.exports=r},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var u=function(t){function e(){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"initialize",value:function(){this.inputNode=this.audioEngine.audioContext.createGain(),this.outputNode=this.inputNode,this.initialized=!0}},{key:"_set",value:function(t){this.value=t;var e=this.outputNode.gain,n=this.audioEngine,i=n.currentTime,r=n.DECAY_DURATION;e.linearRampToValueAtTime(t/100,i+r)}},{key:"dispose",value:function(){this.initialized&&(this.outputNode.disconnect(),this.inputNode=null,this.outputNode=null,this.target=null,this.initialized=!1)}},{key:"DEFAULT_VALUE",get:function(){return 100}},{key:"name",get:function(){return"volume"}}]),e}(n(1));t.exports=u},function(t,e,n){"use strict";var i=n(4);t.exports=i},function(t,e,n){"use strict";var i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done)&&(n.push(u.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var u=n(5),s=n(7),a=n(0),c=n(9),f=n(10),l=n(12),h=n(13),d=n(15),p=n(16),y=n(17),v=n(2),g=n(18),m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;o(this,t),this.audioContext=e,u(this.audioContext),this.inputNode=this.audioContext.createGain(),this.inputNode.connect(this.audioContext.destination),this.audioBuffers={},this.loudness=null,this.effects=[p,y,v]}return r(t,[{key:"getInputNode",value:function(){return this.inputNode}},{key:"_decodeSound",value:function(t){var e,n,i=this,r=t.data.buffer.slice(0),o=c();return(e=this.audioContext,n=r,1===e.decodeAudioData.length?e.decodeAudioData(n):new Promise((function(t,i){e.decodeAudioData(n,(function(e){return t(e)}),(function(t){return i(t)}))}))).catch((function(){if(0===t.data.length)return i._emptySound();var e=t.data.buffer.slice(0);return new f(i.audioContext).decode(e).catch((function(){return i._emptySound()}))})).then((function(t){return[o,t]}),(function(t){a.warn("audio data could not be decoded",t)}))}},{key:"_emptySound",value:function(){return this.audioContext.createBuffer(1,1,this.audioContext.sampleRate)}},{key:"decodeSound",value:function(t){var e=this;return this._decodeSound(t).then((function(t){var n=i(t,2),r=n[0],o=n[1];return e.audioBuffers[r]=o,r}))}},{key:"decodeSoundPlayer",value:function(t){var e=this;return this._decodeSound(t).then((function(t){var n=i(t,2),r=n[0],o=n[1];return new h(e,{id:r,buffer:o})}))}},{key:"getLoudness",value:function(){return this.loudness||(this.loudness=new l(this.audioContext)),this.loudness.getLoudness()}},{key:"createEffectChain",value:function(){var t=new d(this,this.effects);return t.connect(this),t}},{key:"createBank",value:function(){return new g(this,this.createEffectChain())}},{key:"currentTime",get:function(){return this.audioContext.currentTime}},{key:"EFFECT_NAMES",get:function(){return{pitch:"pitch",pan:"pan"}}},{key:"DECAY_DURATION",get:function(){return.025}},{key:"DECAY_WAIT",get:function(){return.05}}]),t}();t.exports=m},function(t,e,n){"use strict";var i=n(6);t.exports=function(t){if("undefined"!=typeof document)return i(t)}},function(t,e){t.exports=require("startaudiocontext")},function(t,e){t.exports=require("audio-context")},function(t,e){t.exports=require("minilog")},function(t,e,n){"use strict";var i="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.exports=function(){for(var t=i.length,e=[],n=0;n<20;n++)e[n]=i.charAt(Math.random()*t);return e.join("")}},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=n(11),o=n(0),u=[7,8,9,10,11,12,13,14,16,17,19,21,23,25,28,31,34,37,41,45,50,55,60,66,73,80,88,97,107,118,130,143,157,173,190,209,230,253,279,307,337,371,408,449,494,544,598,658,724,796,876,963,1060,1166,1282,1411,1552,1707,1878,2066,2272,2499,2749,3024,3327,3660,4026,4428,4871,5358,5894,6484,7132,7845,8630,9493,10442,11487,12635,13899,15289,16818,18500,20350,22385,24623,27086,29794,32767],s=[-1,-1,-1,-1,2,4,6,8,-1,-1,-1,-1,2,4,6,8],a=null,c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.audioContext=e}return i(t,[{key:"decode",value:function(t){var e=this;return new Promise((function(n,i){var u=new r(t);"RIFF"!==u.readUint8String(4)&&(o.warn("incorrect adpcm wav header"),i());var s=u.readInt32();s+8!==t.byteLength&&o.warn("adpcm wav length in header: "+s+" is incorrect"),"WAVE"!==u.readUint8String(4)&&(o.warn("incorrect adpcm wav header"),i());var a=e.extractChunk("fmt ",u);e.encoding=a.readUint16(),e.channels=a.readUint16(),e.samplesPerSecond=a.readUint32(),e.bytesPerSecond=a.readUint32(),e.blockAlignment=a.readUint16(),e.bitsPerSample=a.readUint16(),a.position+=2,e.samplesPerBlock=a.readUint16(),e.adpcmBlockSize=(e.samplesPerBlock-1)/2+4;var c=e.extractChunk("data",u),f=e.numberOfSamples(c,e.adpcmBlockSize),l=e.audioContext.createBuffer(1,f,e.samplesPerSecond);e.imaDecompress(c,e.adpcmBlockSize,l.getChannelData(0)),n(l)}))}},{key:"extractChunk",value:function(t,e){for(e.position=12;e.position<e.getLength()-8;){var n=e.readUint8String(4),i=e.readInt32();if(n===t)return e.extract(i);e.position+=i}}},{key:"numberOfSamples",value:function(t,e){if(!t)return 0;t.position=0;var n=t.getBytesAvailable();return(n/e|0)*(2*(e-4))+1+2*Math.max(n%e-4,0)+Math.min(n%e,1)}},{key:"imaDecompress",value:function(t,e,n){var i=void 0,r=void 0,o=void 0,c=0,f=-1;if(t){t.position=0;for(var l=n.length,h=2*(e-4),d=function(){if(null===a){var t=u.length,e=s.length;a=new Array(t*e).fill(0);for(var n=0,i=0;i<t;i++)for(var r=0;r<e;r++){var o=u[i],c=0;4&r&&(c+=o),2&r&&(c+=o>>1),1&r&&(c+=o>>2),c+=o>>3,a[n++]=8&r?-c:c}}return a}(),p=0;p<l;){i=t.readInt16(),c=t.readUint8(),t.position++,c>88&&(c=88),n[p++]=i/32768;for(var y=Math.min(h,l-p),v=p;p-v<y;)o=d[16*c+(r=15&(f=t.readUint8()))],(c+=s[r])>88?c=88:c<0&&(c=0),(i+=o)>32767?i=32767:i<-32768&&(i=-32768),n[p++]=i/32768,o=d[16*c+(r=f>>4&15)],(c+=s[r])>88?c=88:c<0&&(c=0),(i+=o)>32767?i=32767:i<-32768&&(i=-32768),n[p++]=i/32768}}}}],[{key:"STEP_TABLE",get:function(){return u}},{key:"INDEX_TABLE",get:function(){return s}}]),t}();t.exports=c},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=o._uint8View,s=void 0===u?new Uint8Array(e):u;r(this,t),this.arrayBuffer=e,this.start=n,this.end=i,this._uint8View=s,this._position=n}return i(t,[{key:"extract",value:function(e){return new t(this.arrayBuffer,this._position,this._position+e,this)}},{key:"getLength",value:function(){return this.end-this.start}},{key:"getBytesAvailable",value:function(){return this.end-this._position}},{key:"readUint8",value:function(){var t=this._uint8View[this._position];return this._position+=1,t}},{key:"readUint8String",value:function(t){for(var e=this._uint8View,n="",i=this._position+t,r=this._position;r<i;r++)n+=String.fromCharCode(e[r]);return this._position+=t,n}},{key:"readInt16",value:function(){var t=new Int16Array(this.arrayBuffer,this._position,1)[0];return this._position+=2,t}},{key:"readUint16",value:function(){var t=new Uint16Array(this.arrayBuffer,this._position,1)[0];return this._position+=2,t}},{key:"readInt32",value:function(){var t=void 0;return t=this._position%4==0?new Int32Array(this.arrayBuffer,this._position,1)[0]:new Int32Array(this.arrayBuffer.slice(this._position,this._position+4))[0],this._position+=4,t}},{key:"readUint32",value:function(){var t=new Uint32Array(this.arrayBuffer,this._position,1)[0];return this._position+=4,t}},{key:"position",get:function(){return this._position-this.start},set:function(t){return this._position=t+this.start,t}}]),t}();t.exports=o},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=n(0),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.audioContext=e,this.connectingToMic=!1,this.mic=null}return i(t,[{key:"getLoudness",value:function(){var t=this;if(this.mic||this.connectingToMic||(this.connectingToMic=!0,navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){t.audioStream=e,t.mic=t.audioContext.createMediaStreamSource(e),t.analyser=t.audioContext.createAnalyser(),t.mic.connect(t.analyser),t.micDataArray=new Float32Array(t.analyser.fftSize)})).catch((function(t){r.warn(t)}))),this.mic&&this.audioStream.active){this.analyser.getFloatTimeDomainData(this.micDataArray);for(var e=0,n=0;n<this.micDataArray.length;n++)e+=Math.pow(this.micDataArray[n],2);var i=Math.sqrt(e/this.micDataArray.length);return this._lastValue&&(i=Math.max(i,.6*this._lastValue)),this._lastValue=i,i*=1.63,i=Math.sqrt(i),i=Math.round(100*i),i=Math.min(i,100)}return-1}}]),t}();t.exports=o},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=n(14).EventEmitter,o=n(2),u=function(t){function e(t,n){var i=n.id,r=n.buffer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.id=i,o.audioEngine=t,o.buffer=r,o.outputNode=null,o.volumeEffect=null,o.target=null,o.initialized=!1,o.isPlaying=!1,o.startingUntil=0,o.playbackRate=1,o.handleEvent=o.handleEvent.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"handleEvent",value:function(t){"ended"===t.type&&this.onEnded()}},{key:"onEnded",value:function(){this.emit("stop"),this.isPlaying=!1}},{key:"_createSource",value:function(){null!==this.outputNode&&(this.outputNode.removeEventListener("ended",this.handleEvent),this.outputNode.disconnect()),this.outputNode=this.audioEngine.audioContext.createBufferSource(),this.outputNode.playbackRate.value=this.playbackRate,this.outputNode.buffer=this.buffer,this.outputNode.addEventListener("ended",this.handleEvent),null!==this.target&&this.connect(this.target)}},{key:"initialize",value:function(){this.initialized=!0,this._createSource()}},{key:"connect",value:function(t){return t===this.volumeEffect?(this.outputNode.disconnect(),void this.outputNode.connect(this.volumeEffect.getInputNode())):(this.target=t,this.initialized?(null===this.volumeEffect?(this.outputNode.disconnect(),this.outputNode.connect(t.getInputNode())):this.volumeEffect.connect(t),this):void 0)}},{key:"dispose",value:function(){this.initialized&&(this.stopImmediately(),null!==this.volumeEffect&&(this.volumeEffect.dispose(),this.volumeEffect=null),this.outputNode.disconnect(),this.outputNode=null,this.target=null,this.initialized=!1)}},{key:"take",value:function(){this.outputNode&&this.outputNode.removeEventListener("ended",this.handleEvent);var t=new e(this.audioEngine,this);return t.playbackRate=this.playbackRate,this.isPlaying&&(t.startingUntil=this.startingUntil,t.isPlaying=this.isPlaying,t.initialized=this.initialized,t.outputNode=this.outputNode,t.outputNode.addEventListener("ended",t.handleEvent),t.volumeEffect=this.volumeEffect,t.volumeEffect&&(t.volumeEffect.audioPlayer=t),null!==this.target&&t.connect(this.target),this.emit("stop"),t.emit("play")),this.outputNode=null,this.volumeEffect=null,this.initialized=!1,this.startingUntil=0,this.isPlaying=!1,t}},{key:"play",value:function(){if(this.isStarting)return this.emit("stop"),void this.emit("play");this.isPlaying&&this.stop(),this.initialized?this._createSource():this.initialize(),this.outputNode.start(),this.isPlaying=!0;var t=this.audioEngine,e=t.currentTime,n=t.DECAY_DURATION;this.startingUntil=e+n,this.emit("play")}},{key:"stop",value:function(){if(this.isPlaying){var t=this.take();t.volumeEffect=new o(t.audioEngine,t,null),t.volumeEffect.connect(t.target),t.finished().then((function(){return t.dispose()})),t.volumeEffect.set(0);var e=this.audioEngine,n=e.currentTime,i=e.DECAY_DURATION;t.outputNode.stop(n+i)}}},{key:"stopImmediately",value:function(){this.isPlaying&&(this.outputNode.stop(),this.isPlaying=!1,this.startingUntil=0,this.emit("stop"))}},{key:"finished",value:function(){var t=this;return new Promise((function(e){t.once("stop",e)}))}},{key:"setPlaybackRate",value:function(t){this.playbackRate=t,this.initialized&&(this.outputNode.playbackRate.value=t)}},{key:"isStarting",get:function(){return this.isPlaying&&this.startingUntil>this.audioEngine.currentTime}}]),e}(r);t.exports=u},function(t,e,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,o=r&&"function"==typeof r.apply?r.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var u=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(t,e){return new Promise((function(n,i){function r(n){t.removeListener(e,o),i(n)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",r),n([].slice.call(arguments))}g(t,e,o,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&g(t,"error",e,n)}(t,r,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function c(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function f(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function l(t,e,n,i){var r,o,u,s;if(c(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),u=o[e]),void 0===u)u=o[e]=n,++t._eventsCount;else if("function"==typeof u?u=o[e]=i?[n,u]:[u,n]:i?u.unshift(n):u.push(n),(r=f(t))>0&&u.length>r&&!u.warned){u.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=u.length,s=a,console&&console.warn&&console.warn(s)}return t}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=h.bind(i);return r.listener=n,i.wrapFn=r,r}function p(t,e,n){var i=t._events;if(void 0===i)return[];var r=i[e];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(r):v(r,r.length)}function y(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function g(t,e,n,i){if("function"==typeof t.on)i.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function r(o){i.once&&t.removeEventListener(e,r),n(o)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(t){if("number"!=typeof t||t<0||u(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");a=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||u(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return f(this)},s.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var u;if(e.length>0&&(u=e[0]),u instanceof Error)throw u;var s=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw s.context=u,s}var a=r[t];if(void 0===a)return!1;if("function"==typeof a)o(a,this,e);else{var c=a.length,f=v(a,c);for(n=0;n<c;++n)o(f[n],this,e)}return!0},s.prototype.addListener=function(t,e){return l(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return l(this,t,e,!0)},s.prototype.once=function(t,e){return c(e),this.on(t,d(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return c(e),this.prependListener(t,d(this,t,e)),this},s.prototype.removeListener=function(t,e){var n,i,r,o,u;if(c(e),void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){u=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,r),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,u||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},s.prototype.listeners=function(t){return p(this,t,!0)},s.prototype.rawListeners=function(t){return p(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):y.call(t,e)},s.prototype.listenerCount=y,s.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.audioEngine=e,this.inputNode=this.audioEngine.audioContext.createGain(),this.effects=n;var r=null;this._effects=n.reverse().map((function(t){var n=new t(e,i,r);return i[n.name]=n,r=n,n})).reverse(),this.firstEffect=this._effects[0],this.lastEffect=this._effects[this._effects.length-1],this._soundPlayers=new Set}return i(t,[{key:"clone",value:function(){var e=new t(this.audioEngine,this.effects);return this.target&&e.connect(this.target),e}},{key:"addSoundPlayer",value:function(t){this._soundPlayers.has(t)||(this._soundPlayers.add(t),this.update())}},{key:"removeSoundPlayer",value:function(t){this._soundPlayers.remove(t)}},{key:"getInputNode",value:function(){return this.inputNode}},{key:"connect",value:function(t){var e=this.firstEffect,n=this.lastEffect;if(t===n)return this.inputNode.disconnect(),void this.inputNode.connect(n.getInputNode());t!==e&&(this.target=t,e.connect(t))}},{key:"getSoundPlayers",value:function(){return[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(this._soundPlayers))}},{key:"setEffectsFromTarget",value:function(t){this._effects.forEach((function(e){"soundEffects"in t&&e.name in t.soundEffects?e.set(t.soundEffects[e.name]):e.name in t&&e.set(t[e.name])}))}},{key:"set",value:function(t,e){t in this&&this[t].set(e)}},{key:"update",value:function(){this._effects.forEach((function(t){return t.update()}))}},{key:"clear",value:function(){this._effects.forEach((function(t){return t.clear()}))}},{key:"dispose",value:function(){this._soundPlayers=null,this._effects.forEach((function(t){return t.dispose()})),this._effects=null}}]),t}();t.exports=r},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(t){function e(t,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i));return r.leftGain=null,r.rightGain=null,r.channelMerger=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"initialize",value:function(){var t=this.audioEngine.audioContext;this.inputNode=t.createGain(),this.leftGain=t.createGain(),this.rightGain=t.createGain(),this.channelMerger=t.createChannelMerger(2),this.outputNode=this.channelMerger,this.inputNode.connect(this.leftGain),this.inputNode.connect(this.rightGain),this.leftGain.connect(this.channelMerger,0,0),this.rightGain.connect(this.channelMerger,0,1),this.initialized=!0}},{key:"_set",value:function(t){this.value=t;var e=(t+100)/200,n=Math.cos(e*Math.PI/2),i=Math.sin(e*Math.PI/2),r=this.audioEngine,o=r.currentTime,u=r.DECAY_WAIT,s=r.DECAY_DURATION;this.leftGain.gain.setTargetAtTime(n,o+u,s),this.rightGain.gain.setTargetAtTime(i,o+u,s)}},{key:"dispose",value:function(){this.initialized&&(this.inputNode.disconnect(),this.leftGain.disconnect(),this.rightGain.disconnect(),this.channelMerger.disconnect(),this.inputNode=null,this.leftGain=null,this.rightGain=null,this.channelMerger=null,this.outputNode=null,this.target=null,this.initialized=!1)}},{key:"name",get:function(){return"pan"}}]),e}(n(1));t.exports=r},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(t){function e(t,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i));return r.ratio=1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"getInputNode",value:function(){return this.target.getInputNode()}},{key:"initialize",value:function(){this.initialized=!0}},{key:"_set",value:function(t){this.value=t,this.ratio=this.getRatio(this.value),this.updatePlayers(this.audioPlayer.getSoundPlayers())}},{key:"update",value:function(){this.updatePlayers(this.audioPlayer.getSoundPlayers())}},{key:"getRatio",value:function(t){var e=t/10;return Math.pow(2,e/12)}},{key:"updatePlayer",value:function(t){t.setPlaybackRate(this.ratio)}},{key:"updatePlayers",value:function(t){if(t)for(var e in t)t.hasOwnProperty(e)&&this.updatePlayer(t[e])}},{key:"name",get:function(){return"pitch"}},{key:"_isPatch",get:function(){return!1}}]),e}(n(1));t.exports=r},function(t,e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=n(0),o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.audioEngine=e,this.soundPlayers={},this.playerTargets=new Map,this.soundEffects=new Map,this.effectChainPrime=n}return i(t,[{key:"addSoundPlayer",value:function(t){this.soundPlayers[t.id]=t}},{key:"getSoundPlayer",value:function(t){return this.soundPlayers[t]||r.error("SoundBank.getSoundPlayer("+t+"): called missing sound in bank"),this.soundPlayers[t]}},{key:"getSoundEffects",value:function(t){return this.soundEffects.has(t)||this.soundEffects.set(t,this.effectChainPrime.clone()),this.soundEffects.get(t)}},{key:"playSound",value:function(t,e){var n=this.getSoundEffects(e),i=this.getSoundPlayer(e);return this.playerTargets.get(e)!==t&&i.stop(),this.playerTargets.set(e,t),n.addSoundPlayer(i),n.setEffectsFromTarget(t),i.connect(n),i.play(),i.finished()}},{key:"setEffects",value:function(t){var e=this;this.playerTargets.forEach((function(n,i){n===t&&e.getSoundEffects(i).setEffectsFromTarget(t)}))}},{key:"stop",value:function(t,e){this.playerTargets.get(e)===t&&this.soundPlayers[e].stop()}},{key:"stopAllSounds",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";this.playerTargets.forEach((function(n,i){"*"!==e&&n!==e||t.getSoundPlayer(i).stop()}))}},{key:"dispose",value:function(){for(var t in this.playerTargets.clear(),this.soundEffects.forEach((function(t){return t.dispose()})),this.soundEffects.clear(),this.soundPlayers)this.soundPlayers.hasOwnProperty(t)&&this.soundPlayers[t].dispose();this.soundPlayers={}}}]),t}();t.exports=o}]);
//# sourceMappingURL=dist.js.map